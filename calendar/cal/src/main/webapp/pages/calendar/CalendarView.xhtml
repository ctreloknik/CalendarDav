<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

	<h:form id="calendarForm">
		<nav class="navbar navbar-default">
		<div class="container-fluid">
			<ul class="nav navbar-nav">
				<li><a href="#" onclick="openDialog()">Создать событие</a></li>
				<li><a href="#" onclick="openInvitesDialog()">Приглашения</a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li><a href="/pages/Basic.xhtml" onclick="logout()">Выход</a></li>
			</ul>
		</div>
		</nav>

		<div class="col-md-3" style="width: 280px; left: 5px;">
			<p:calendar id="calendar" widgetVar="calendar"
				value="#{calendarHome.calendarDate}" mode="inline" navigator="true"
				pages="1">
				<p:ajax event="dateSelect" listener="#{eventsList.onDateSelect}"
					update="eventsListDetails" />
			</p:calendar>

			<div class="well well-sm" style="min-width: 200px">
				<p:outputLabel value="Фильтр по категориям:" />
				<p:selectCheckboxMenu id="filterCategories"
					widgetVar="filterCategories"
					style="min-width: 200px; display: block"
					value="#{eventsList.selectedCategories}" label="Категории"
					filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
					<f:selectItems value="#{eventsList.allCategories}" />
				</p:selectCheckboxMenu>

				<p:commandButton value="Отфильтровать" style="top: 5px;"
					oncomplete="updateEventsList()" />
			</div>

			<div class="well well-sm">
				<p:outputLabel value="Фильтр по дате:" />
				<p:selectOneMenu id="filterDate"
					value="#{eventsList.selectedFilterDate}"
					style="min-width: 200px; display: block">
					<f:selectItems value="#{eventsList.filtesrOnFuture}" />
				</p:selectOneMenu>

				<p:commandButton value="Отфильтровать" style="top: 5px;"
					oncomplete="dateFilter()" />
			</div>
		</div>

		<div class="col-md-9">
			<ui:include src="/pages/calendar/EventsList.xhtml" />
		</div>

		<p:remoteCommand name="openDialog"
			action="#{eventHome.preCreateEvent()}"
			update=":calendarForm:eventEditDlg"
			oncomplete="PF('eventEditDlg').show();"></p:remoteCommand>

		<p:remoteCommand name="openInvitesDialog"
			update=":calendarForm:invitesTable"
			oncomplete="PF('invitesDlg').show();"></p:remoteCommand>

		<p:remoteCommand name="updateEventsList"
			action="#{eventsList.getEventsByFilter()}" update="eventsListDetails"></p:remoteCommand>

		<p:remoteCommand name="dateFilter"
			action="#{eventsList.getEventsByDatefilter()}" update="eventsListDetails"></p:remoteCommand>
			
		<p:remoteCommand name="logout" action="#{eventHome.logout()}"
			update="calendarForm"></p:remoteCommand>

		<ui:include src="/pages/calendar/dailogs/EventEditDlg.xhtml" />
		<ui:include src="/pages/calendar/dailogs/InvitesDlg.xhtml" />
	</h:form>
</ui:composition>
